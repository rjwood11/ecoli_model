"0",""
"0",""
"0","#map = {"
"0","#ggplot() +"
"0","#  geom_sf(data = river$osm_lines,"
"0","#          inherit.aes = FALSE,"
"0","#          color = ""steelblue"","
"0","#          size = .8,"
"0","#          alpha = .3) +"
"0","#  geom_sf_text(data = river$osm_lines, aes(label = name), color=""blue"") +"
"0","#  geom_sf(data = med_streets$osm_lines,"
"0","#         inherit.aes = FALSE,"
"0","#         color = ""black"","
"0","#         size = .3,"
"0","#         alpha = .5) +"
"0","#  geom_sf(data = big_streets$osm_lines,"
"0","#          inherit.aes = FALSE,"
"0","#          color = ""black"","
"0","#          size = .5,"
"0","#          alpha = .6) +"
"0","#  coord_sf(xlim = c(-87.15477, -86.51559), "
"0","#           ylim = c(35.86778, 36.40550),"
"0","#          expand = FALSE)  +"
"0","# geom_point(data=site_coords, aes(x=Longitude, y=Latitude, text = paste(station_nm, '\n', 'USGS Station', site_no), color = Status), size = 2, alpha=.8, #inherit.aes = F) +"
"0","#  scale_colour_manual(values = cols, drop = FALSE) +"
"0","#  theme_void() +"
"0","#  theme(plot.title = element_text(size = 20, face=""bold"", hjust=.5),"
"0","#        plot.subtitle = element_text(size = 8, hjust=.5, margin=margin(2, 1, 5, 1))) +"
"0","#  labs(title = ""Nashville"", subtitle = ""USGS River Gauge Sites"") +"
"0","#  labs(caption=str_c(""Last update: "", time,  "" Central Time."")) +"
"0","#  theme(legend.position=""bottom"")"
"0",""
"0","#}"
"0","  "
"0","#plotly::ggplotly(map)"
"0",""
"0",""
"0","#cbin<-colorBin(""Blues"",3, site_coords$Status,na.color = ""#808080"",pretty=F)"
"0",""
"0","#cnum<-colorNumeric(c(""green"",""yellow"",""red""), domain=site_coords$ecoli)"
"0",""
"0","cfac<-colorFactor(c(""green"",""yellow"",""red""), levels=c(""Safe"",""Caution"",""Warning""),na.color = ""grey"", ordered=F)"
"0",""
"0",""
"0",""
"0","#p<-leaflet() %>% "
"0","#  setView(lng = -86.791425, lat = 36.08, zoom = 10) %>%"
"0","#  addTiles() %>%"
"0","#  addCircleMarkers(data=site_coords[c(1:4,6:9),], lat=~Latitude, lng= ~Longitude, color = ~cfac(Forecast$Status))"
"0",""
"0","#p"
"0",""
"0","Forecast2<-Forecast"
"0",""
"0",""
"0",""
"0","#Forecast<-Forecast2"
"0",""
"0","Forecast %<>% "
"0","  st_as_sf(coords = c(""Longitude"", ""Latitude"")) %>% "
"0","  st_sf(crs = 84)"
"0",""
"0","Forecast<-Forecast %>% "
"0","  mutate(popup = paste(""<b>Location: </b>"", Forecast$Location, "
"0","                       ""<br/>"","
"0","                       ""<b>E. coli:</b>"", Forecast$ecoli,"
"0","                       ""<br/>"","
"0","                       ""<b>Status:</b>"", Forecast$Status,"
"0","                       ""<br/>""))"
"0",""
"0",""
"0","p<-leaflet() %>% "
"0","  addTiles() %>% "
"0","  addProviderTiles(providers$OpenStreetMap, group = 'Open SM')  %>%"
"0","  addProviderTiles(providers$Stamen.Toner, group = 'Toner')  %>%"
"0","  addProviderTiles(providers$Esri.NatGeoWorldMap, group = 'NG World') %>%"
"0","  addProviderTiles(providers$Esri.NatGeoWorldMap) %>%"
"0","  setView(lng = -86.791425, lat = 36.08, zoom = 10) %>% "
"0","  addCircleMarkers(data = Forecast ,popup = ~popup, color=~cfac(Forecast$Status),fill=T, stroke=T, fillOpacity = 1.0) %>%"
"0","  addWMSTiles("
"0","    ""http://mesonet.agron.iastate.edu/cgi-bin/wms/nexrad/n0r.cgi"","
"0","    layers = ""nexrad-n0r-900913"", "
"0","    options = WMSTileOptions(format = ""image/png"", transparent = TRUE),"
"0","    attribution = ""Weather data Â© 2012 IEM Nexrad"") %>%"
"0","  addLegend('topright', pal = cfac, values = as.character(c(""Safe"",""Caution"",""Warning"",""Data Unavailable"")),"
"0","            title = 'Public Safety Status',"
"0","            opacity = 1) %>%"
"0","  addLegend(""bottomright"", colors = c( 'blue', 'green', 'yellow', 'orange', ""red""), values = c(5,15,25,35,45,55,65),"
"0","            title = ""Current Precipitation"","
"0","            labels = c(""Less Dense"", """", """","""", ""More Dense""),"
"0","            opacity = 1) "
"0",""
"0",""
"0","p"
